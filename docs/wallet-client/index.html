<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="images/favicon.png" >

  <title>
    Home - Documentation
  </title>

  <script src="scripts/prettify/prettify.js"></script>
  <script src="scripts/prettify/lang-css.js"></script>

  <link type="text/css" rel="stylesheet" href="styles/elv-jsdoc.css">
  <link type="text/css" rel="stylesheet" href="styles/elv-prettify-jsdoc.css">
</head>

<body>
  <div class="layout-container">
    <nav class="nav-container">
      <div class="header">
        <a href="index.html">
          <img class="logo" src="images/logo-dark.png" />
        </a>
        <div class="title">
          Eluvio Wallet Client
        </div>
      </div>
      <div class="nav-content">
        <h3>Classes</h3><ul><li id="ElvWalletClient-nav">
          <div data-name="ElvWalletClient" class="class-link-container"><a class="class-link">ElvWalletClient</a></div><ul class='methods'><h4 class="methodGroupHeader">Constructor</h4><li data-type="method" id="ElvWalletClient-ElvWalletClient-nav"><a href="ElvWalletClient.html" class="method-link">ElvWalletClient</a></li><h4 class="methodGroupHeader">Authorization</h4><li data-type="method" id="ElvWalletClient-Authenticate-nav"><a href="ElvWalletClient.html#Authenticate" class="method-link">Authenticate</a></li><li data-type="method" id="ElvWalletClient-AuthenticateExternalWallet-nav"><a href="ElvWalletClient.html#AuthenticateExternalWallet" class="method-link">AuthenticateExternalWallet</a></li><li data-type="method" id="ElvWalletClient-AuthenticateOAuth-nav"><a href="ElvWalletClient.html#AuthenticateOAuth" class="method-link">AuthenticateOAuth</a></li><h4 class="methodGroupHeader">Initialization</h4><li data-type="method" id="ElvWalletClient-Initialize-nav"><a href="ElvWalletClient.html#.Initialize" class="method-link">Initialize</a></li><h4 class="methodGroupHeader">Login</h4><li data-type="method" id="ElvWalletClient-LogIn-nav"><a href="ElvWalletClient.html#LogIn" class="method-link">LogIn</a></li><li data-type="method" id="ElvWalletClient-LogOut-nav"><a href="ElvWalletClient.html#LogOut" class="method-link">LogOut</a></li><h4 class="methodGroupHeader">Methods</h4><li data-type="method" id="ElvWalletClient-ClientAuthToken-nav"><a href="ElvWalletClient.html#ClientAuthToken" class="method-link">ClientAuthToken</a></li></ul></li></ul><h3>Modules</h3><ul><li id="ClientMethods-nav">
          <div data-name="ClientMethods" class="class-link-container"><a class="class-link">ClientMethods</a></div><ul class='methods'><li data-type="method" id="ClientMethods-ClientMethods-nav"><a href="module-ClientMethods.html" class="method-link">ClientMethods</a></li><h4 class="methodGroupHeader">Items</h4><li data-type="method" id="ClientMethods-NFT-nav"><a href="module-ClientMethods.html#.NFT" class="method-link">NFT</a></li><h4 class="methodGroupHeader">Listings</h4><li data-type="method" id="ClientMethods-CreateListing-nav"><a href="module-ClientMethods.html#.CreateListing" class="method-link">CreateListing</a></li><li data-type="method" id="ClientMethods-Listing-nav"><a href="module-ClientMethods.html#.Listing" class="method-link">Listing</a></li><li data-type="method" id="ClientMethods-ListingAttributes-nav"><a href="module-ClientMethods.html#.ListingAttributes" class="method-link">ListingAttributes</a></li><li data-type="method" id="ClientMethods-ListingEditionNames-nav"><a href="module-ClientMethods.html#.ListingEditionNames" class="method-link">ListingEditionNames</a></li><li data-type="method" id="ClientMethods-ListingNames-nav"><a href="module-ClientMethods.html#.ListingNames" class="method-link">ListingNames</a></li><li data-type="method" id="ClientMethods-Listings-nav"><a href="module-ClientMethods.html#.Listings" class="method-link">Listings</a></li><li data-type="method" id="ClientMethods-ListingStats-nav"><a href="module-ClientMethods.html#.ListingStats" class="method-link">ListingStats</a></li><li data-type="method" id="ClientMethods-ListingStatus-nav"><a href="module-ClientMethods.html#.ListingStatus" class="method-link">ListingStatus</a></li><li data-type="method" id="ClientMethods-RemoveListing-nav"><a href="module-ClientMethods.html#.RemoveListing" class="method-link">RemoveListing</a></li><li data-type="method" id="ClientMethods-Sales-nav"><a href="module-ClientMethods.html#.Sales" class="method-link">Sales</a></li><li data-type="method" id="ClientMethods-SalesStats-nav"><a href="module-ClientMethods.html#.SalesStats" class="method-link">SalesStats</a></li><h4 class="methodGroupHeader">Marketplaces</h4><li data-type="method" id="ClientMethods-AvailableMarketplaces-nav"><a href="module-ClientMethods.html#.AvailableMarketplaces" class="method-link">AvailableMarketplaces</a></li><li data-type="method" id="ClientMethods-Marketplace-nav"><a href="module-ClientMethods.html#.Marketplace" class="method-link">Marketplace</a></li><li data-type="method" id="ClientMethods-MarketplaceCSS-nav"><a href="module-ClientMethods.html#.MarketplaceCSS" class="method-link">MarketplaceCSS</a></li><li data-type="method" id="ClientMethods-MarketplaceInfo-nav"><a href="module-ClientMethods.html#.MarketplaceInfo" class="method-link">MarketplaceInfo</a></li><li data-type="method" id="ClientMethods-MarketplaceStock-nav"><a href="module-ClientMethods.html#.MarketplaceStock" class="method-link">MarketplaceStock</a></li><h4 class="methodGroupHeader">NFT</h4><li data-type="method" id="ClientMethods-TransferNFT-nav"><a href="module-ClientMethods.html#.TransferNFT" class="method-link">TransferNFT</a></li><h4 class="methodGroupHeader">Status</h4><li data-type="method" id="ClientMethods-ClaimStatus-nav"><a href="module-ClientMethods.html#.ClaimStatus" class="method-link">ClaimStatus</a></li><li data-type="method" id="ClientMethods-CollectionRedemptionStatus-nav"><a href="module-ClientMethods.html#.CollectionRedemptionStatus" class="method-link">CollectionRedemptionStatus</a></li><li data-type="method" id="ClientMethods-ListingPurchaseStatus-nav"><a href="module-ClientMethods.html#.ListingPurchaseStatus" class="method-link">ListingPurchaseStatus</a></li><li data-type="method" id="ClientMethods-PackOpenStatus-nav"><a href="module-ClientMethods.html#.PackOpenStatus" class="method-link">PackOpenStatus</a></li><li data-type="method" id="ClientMethods-PurchaseStatus-nav"><a href="module-ClientMethods.html#.PurchaseStatus" class="method-link">PurchaseStatus</a></li><h4 class="methodGroupHeader">Tenants</h4><li data-type="method" id="ClientMethods-TenantConfiguration-nav"><a href="module-ClientMethods.html#.TenantConfiguration" class="method-link">TenantConfiguration</a></li><h4 class="methodGroupHeader">User</h4><li data-type="method" id="ClientMethods-UserAddress-nav"><a href="module-ClientMethods.html#.UserAddress" class="method-link">UserAddress</a></li><li data-type="method" id="ClientMethods-UserInfo-nav"><a href="module-ClientMethods.html#.UserInfo" class="method-link">UserInfo</a></li><li data-type="method" id="ClientMethods-UserItemInfo-nav"><a href="module-ClientMethods.html#.UserItemInfo" class="method-link">UserItemInfo</a></li><li data-type="method" id="ClientMethods-UserItems-nav"><a href="module-ClientMethods.html#.UserItems" class="method-link">UserItems</a></li><li data-type="method" id="ClientMethods-UserListings-nav"><a href="module-ClientMethods.html#.UserListings" class="method-link">UserListings</a></li><li data-type="method" id="ClientMethods-UserSales-nav"><a href="module-ClientMethods.html#.UserSales" class="method-link">UserSales</a></li><li data-type="method" id="ClientMethods-UserWalletBalance-nav"><a href="module-ClientMethods.html#.UserWalletBalance" class="method-link">UserWalletBalance</a></li></ul></li></ul>
      </div>
    </nav>

    <div class="main">
      <div class="header"></div>
      <div class="main-content">
        

        
      



    

      


  <section class="readme">
    <article>
      <h1>Eluvio Wallet Client</h1>
<p>This is a standalone client for using Eluvio Media Wallet functionality</p>
<p>For information about the embedded wallet app frame client, see <a href="https://eluv-io.github.io/elv-media-wallet/ElvWalletFrameClient.html">here</a></p>
<h2>Initializing the Client</h2>
<p>Initializing the client is as simple as calling the static Initialize method with the network (main or demo) and the mode (production or staging) the client should operate upon, as well as (optionally) the marketplace to associate the client with.</p>
<pre class="prettyprint source lang-javascript"><code>await ElvWalletClient.Initialize({
  network: &quot;main | demo&quot;,
  mode: &quot;production | staging&quot;,
  marketplaceParams: {
    tenantSlug,
    marketplaceSlug
  }
})
</code></pre>
<h2>Referencing Marketplaces</h2>
<p>Many methods, including the Initialize method, take a parameter called <code>marketplaceParams</code>. This parameter should be specified in one of the following formats:</p>
<p>Specify the tenant slug and marketplace slug corresponding to your marketplace.</p>
<pre class="prettyprint source lang-javascript"><code>{
  tenantSlug: &quot;&lt;tenant-slug>&quot;, 
  marketplaceSlug: &quot;&lt;marketplace-slug>&quot;
}
</code></pre>
<p>Specify the object ID of the marketplace</p>
<pre class="prettyprint source lang-javascript"><code>{ marketplaceId: &quot;iq__abc123&quot; }
</code></pre>
<p>Specify a version hash of the marketplace</p>
<pre class="prettyprint source lang-javascript"><code>{ marketplaceHash: &quot;hq__abc123&quot; }
</code></pre>
<h2>Handling Login</h2>
<p>The wallet client make it simple to log in with the Eluvio Media Wallet. However, if you are also using the frame client to embed the wallet application, extra care must be taken to ensure the login flow is handled correctly and the wallet client and frame have parity in their authorization states.</p>
<div id="wallet-client" />
<h3>Wallet Client</h3>
<h5>Redirect Flow</h5>
<pre class="prettyprint source lang-javascript"><code>walletClient.LogIn({
  method: &quot;redirect&quot;,
  callbackUrl: &lt;https://your-domain.com/callback>
});
</code></pre>
<p>Upon login, the browser will return to the callbackUrl with the authorization token as a url parameter (<code>elvToken</code>). <strong>Initializing the client will automatically pull the token out of the URL parameters and log in.</strong></p>
<p>If you don't want to initialize the client in the callback URL, you can save this token and later set it in the client using the <code>Authenticate</code> method.</p>
<pre class="prettyprint source lang-javascript"><code>const searchParams = new URLSearchParams(window.location.search);
const clientAuthToken = searchParams.get(&quot;elvToken&quot;);

...

walletClient.Authorize({token: clientAuthToken});

</code></pre>
<h5>Popup Flow</h5>
<pre class="prettyprint source lang-javascript"><code>try {
  await walletClient.LogIn({
    method: &quot;popup&quot;
  })
} catch(error) {
  // User closed popup
}
</code></pre>
<h5>Additional Options</h5>
<p>The <code>clear</code> parameter in the LogIn method will ensure that the user does the full log in flow, even if they are already logged in to the Eluvio Media Wallet application. This is important to specify if the user has logged out from your application, as they will otherwise still be logged in to the Media Wallet and the login flow will simply authorize them as the same user.</p>
<p>The <code>provider</code> parameter will automatically proceed to log in with the specified provider instead of presenting the usual login screen and waiting for the user to choose. For example, you can specify that the login flow should automatically prompt for Metamask login or proceed to the OAuth login flow. For the OAuth flow, the <code>mode</code> parameter can be used to proceed to the <code>login</code> flow or the <code>create</code> account flow.</p>
<h5>Saving Authorization</h5>
<p>By default, the client will save the authorization token in localstorage, if available. If you prefer to handle storing the authorization token differently, you can specify that the client should not save the token when initializing the client:</p>
<pre class="prettyprint source lang-javascript"><code>const walletClient = ElvWalletClient.Initialize({
  ...,
  storeAuthToken: false
})
</code></pre>
<p>The authorization token can be retrieved using <code>walletClient.ClientAuthToken()</code>, which can then be used later in the <code>Authenticate</code> method.</p>
<h3>Frame Client</h3>
<p>If you only want to embed the Eluvio Media Wallet application without using the Wallet Client and you don't want to implement a custom login screen, no special effort is needed. The wallet app UI will handle login natively.</p>
<p>You can use event listeners with the frame client to detect when the user logs in or out:</p>
<pre class="prettyprint source lang-javascript"><code>frameClient.AddEventListener(frameClient.EVENTS.LOG_IN, ({address}) => { ... });

frameClient.AddEventListener(frameClient.EVENTS.LOG_OUT, () => { ... });
</code></pre>
<h3>Custom Login UI For Embedded Wallet App / Using Both Wallet Client and Frame Client</h3>
<p>If you want to implement a custom login screen for the embedded wallet application, or if you want to use both the wallet and frame clients in the same application, some care must be taken to ensure the login flow is handled correctly and the wallet client and frame have parity in their authorization states.</p>
<p>First, <strong>login should be handled by the Wallet Client only</strong>. The wallet client does not have to deal with the limitations of iframes, and the wallet client is allowed access to the user's authorization token, which can be passed to the frame client to authorize the embedded application.</p>
<p>Authorization can be passed to the embedded frame, but <strong>cannot be retrieved</strong> from it. Because of this, logging in via the embedded application would mean the user is logged in in the frame, but the wallet client in the containing application has no access to that user's authorization.</p>
<p>Here's how to handle this case:</p>
<h5>Perform Login Using the Wallet Client</h5>
<p>See the <a href="#wallet-client">Wallet Client</a> login section for details about how to handle the login flow with the wallet client.</p>
<h5>Capture Login from the Frame</h5>
<p>When initializing the frame client, specify the <code>captureLogin</code> option. This will cause login prompts (e.g. user clicks log in, user tries to perform/access something that requires login, etc.) to emit an event instead of presenting the login form in the frame.</p>
<pre class="prettyprint source lang-javascript"><code>const frameClient = await ElvWalletFrameClient.InitializeFrame({
  ...,
  captureLogin: true
})
</code></pre>
<p>You can then listen for that event to present your own login screen, or simply trigger the login flow with the Wallet Client.</p>
<pre class="prettyprint source lang-javascript"><code>frameClient.AddEventListener(
  frameClient.EVENTS.LOG_IN_REQUESTED,
  () => {
    // Show your login screen or log in with wallet client
    // ShowLogin()
    // walletClient.LogIn({...});
  }
)
</code></pre>
<h5>Pass Authorization Token to Frame Client</h5>
<p>When the login flow has completed with the wallet client, pass the authorization token to the embedded application:</p>
<pre class="prettyprint source lang-javascript"><code>if(walletClient.ClientAuthToken()) {
  await frameClient.LogIn({clientAuthToken: walletClient.ClientAuthToken()})
}
</code></pre>
<h5>Handle Log Out in Both Clients</h5>
<p>After the user is logged in with the frame client, you can present an option to log out. Be sure this logs out both the wallet client and the frame client:</p>
<pre class="prettyprint source lang-javascript"><code>function LogOutFromMyApp() {
  walletClient.LogOut();
  frameClient.LogOut();
}
</code></pre>
<p>Additionally, the user may log out from the embedded application. Use an event listener in the frame client to handle this and log out from the wallet client:</p>
<pre class="prettyprint source lang-javascript"><code>frameClient.AddEventListener(
  frameClient.EVENTS.LOG_OUT,
  () => LogOutFromMyApp()
);
</code></pre>
    </article>
  </section>


    



        <footer class="footer">
          Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a>
        </footer>
      </div>
    </div>
  </div>

  <script>
    // Format and add line numbers to code
    prettyPrint();
  </script>

  <script type="text/javascript" src="scripts/utils.js"></script>

  </body>
</html>